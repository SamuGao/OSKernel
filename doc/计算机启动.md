# 计算机初始化
> 当计算机上电初始化时，物理内存被设置成从地址0开始的连续区域。除了地址从0xA0000到0xFFFFF（640K到1M共384K）和0xFFFE0000到0xFFFFFFFF（4G处的最后64K）范围以外的所有内存都可用作系统内存，这两个特定范围被用于I/O设备和BIOS程序。   
> 当计算机系统上电开机或者按了机箱上的复位按钮时，CPU会自动把代码段寄存器CS设置为0xF000，其段基地址则被设置为0xFFFF0000，段长度设置为64KB。而IP被设置为0xFFF0，因此此时CPU代码指针指向0xFFFFFFF0处，即4G空间最后一个64K的最后16字节处，并且BIOS会在这里存放一条跳转指令JMP转跳到BIOS代码中64KB范围内的某一条指令开始执行。  

BIOS代码执行完开机检查等动作后，会把硬盘或其他设备的第一扇区512B的代码加载到内存0x7c00处，并跳转到这个地方开始执行程序。
# 软盘结构
开机后会把启动设备前512B的程序读进0x7c00处，如果启动设备是软盘，那么刚好是软盘的一个扇区。以前常见的3.5寸1.44M软盘有两个磁头，正反面各一个，80个磁道，每个磁道18个扇区，每个扇区512字节，所以   
`容量=512字节/扇区*2面*80磁道*18扇区/磁道=1440KB`
# BIOS INT 0x13中断
***
`INT 0x13, 功能02`   
***
`参数：`

`AH          02`

`AL          读取扇区数`

`CH          柱面[0,79]`

`CL          扇区[1, 18]`

`DH          磁头[0, 1]`

`DL          驱动器（0x0 ~ 0x7f表示软盘，0x80 ~ 0xff表示硬盘）`

`ES:BX       缓冲区地址，即数据读到这里`

`返回值`

`CF=0        表示操作成功，此时AH=0, AL=传输的扇区数`

`CF=1        即carry位置位（可用JC表示跳转）表示操作失败，AH=状态吗`


# 引导程序
计算机启动自检完毕后，会把按设置的启动设备顺序检测导入引导程序到0x7c00h处，并跳转到此处开始执行，只会导入512B的代码到0x7c00h处，并且最后两个字节必须是0x55AAh，否则不能被引导。   
因为计算机只会把512B的程序载入到内存，而一般操作系统的大小肯定远远要超过这个大小，所以一般这512B的程序都肩负起把操作系统真正的内核载入内存的使命，它并不算是真正的操作系统内核，而是叫做引导程序，负责引导内核到内存。   
因为计算机刚启动，并没有太多功能，引导程序一般使用BIOS的int 0x13h中断读取软盘或磁盘来进行载入内核。   
一般来讲引导程序可以将内核载入到内存任意地方，但是因为BIOS的中断向量表是在内存0x0000h处的，而我们载入内核用到了BIOS的中断进行载入，所以刚开始一般不能载入到0x0000h处。像linux操作系统是先将内核载入到0x10000h处，又因为BIOS的中断不支持重入，所以linux在载入内核后实际是重写了中断，所以一旦载入内核后，中断向量表实际是没用了，因此linux内核载入成功后，又会自动拷贝到0x0000h处，再条到此处开始执行。   
# 实模式到保护模式跳转



